{% extends webapp_config['LAYOUT'] %}

{% block meta_copydoc %}https://docs.google.com/spreadsheets/d/1gN_xcaAFFP_ckDvWeNDpD9ogbRXFgcXN0w0ITZQB0e4/edit#gid=779498506{% endblock %}

{% block content %}
  <div id="main-content" class="p-strip">
    {% set fsf_step = "package" %}
    {% include "first-snap/_breadcrumb.html" %}

    <div class="row">
      <p>Now we'll take a real world app, and package it as a snap</p>
    </div>

    <div class="row">
      <div class="col-8">
        <ol class="p-list-step has-margin">
          <li class="p-list-step__item">
            <h4 class="p-list-step__title">
              <span class="p-list-step__bullet">1</span>
              Download a copy of the app
            </h4>
            {% set snippet_value = steps.download %}
            {% set snippet_id = "download" %}
            {% include "/partials/_code-snippet.html" %}
          </li>
          <li class="p-list-step__item">
            <h4 class="p-list-step__title">
              <span class="p-list-step__bullet">2</span>
              Open the snapcraft.yaml file in the root of the project
            </h4>
            <p class="p-list-step__content">Create a snap/directory and begin a snapcraft.yaml file</p>
            {% set snippet_value = steps.createDir %}
            {% set snippet_id = "createdir" %}
            {% include "/partials/_code-snippet-multi.html" %}
          </li>
          <li class="p-list-step__item">
            <h4 class="p-list-step__title">
              <span class="p-list-step__bullet">3</span>
              The snapcraft.yaml file starts with a small amount of human-readable metadata.
            </h4>
            <div class="p-list-step__content">
              {% set snippet_value = steps.metadata %}
              {% set snippet_id = "metadata" %}
              {% include "/partials/_code.html" %}
              <p>The name must be unique in the Snap Store. Valid snap names consist of lower-case alphanumeric characters and hyphens. They cannot be all numbers. They also cannot start or end with a hyphen.</p>
              <pre><code>name: offlineimap</code></pre>
              <div class="p-notification--caution">
                <p class="p-notification__response">
                  <span class="p-notification__status"></span>
                  You should change any instance of <code>offlineimap</code> to <code>test-offlineimap-{name}</code> (where <code>{name}</code> is your name) before continuing to avoid conflicts later in this guide.
                </p>
              </div>
              <p>By specifying git for the version, the current git tag or commit will be used as the version string. Versions carry no semantic meaning in snaps.</p>
              <pre><code>version: git</code></pre>
              <p>The summary can not exceed 79 characters. You can use a chevron ‘>’ in the description key to declare a multi-line description.</p>
              <pre><code>description: ></code></pre>

            </div>
          </li>
          <li class="p-list-step__item">
            <h4 class="p-list-step__title">
              <span class="p-list-step__bullet">4</span>
              Security model
            </h4>
            <div class="p-list-step__content">
              <p>The next section describes the level of confinement applied to your app.</p>
              <pre><code>confinement: devmode</code></pre>
              <p>Snaps are containerised to ensure more predictable application behaviour and greater security.</p>
              <p>It’s best to start a snap with the confinement in warning mode, rather than strictly applied. This is indicated through the <code>devmode</code> keyword.</p>
              <p>Once an app is working well in devmode, you can review confinement violations, add appropriate interfaces, and switch to strict confinement.</p>
            </div>
          </li>
          <li class="p-list-step__item">
            <h4 class="p-list-step__title">
              <span class="p-list-step__bullet">5</span>
              Parts
            </h4>
            <div class="p-list-step__content">
              <p>Parts define what sources are needed to assemble your app. Parts can be anything: programs, libraries, or other needed assets.</p>
              {% set snippet_value = steps.parts %}
              {% set snippet_id = "parts" %}
              {% include "/partials/_code.html" %}
              <p>The <code>python</code> plugin builds upon the work you’ve already done to describe your Python dependencies in <code>setup.py</code> and <code>requirements.txt</code>. It will automatically include these in your snap.</p>
              <p>The <code>python-version</code> keyword instructs the python plugin to include a copy of Python 2 in your snap.</p>
              <p>The <code>source</code> keyword points to the root of your Python project and can be a local directory or remote Git repository.</p>
            </div>
          </li>
          <li class="p-list-step__item">
            <h4 class="p-list-step__title">
              <span class="p-list-step__bullet">6</span>
              Apps
            </h4>
            <div class="p-list-step__content">
              <p>Apps are the commands you want to expose to users and any background services your application provides.</p>
              {% set snippet_value = steps.apps %}
              {% set snippet_id = "apps" %}
              {% include "/partials/_code.html" %}
              <div class="p-notification--caution">
                <p class="p-notification__response">
                  <span class="p-notification__status"></span>
                  You should change any instance of <code>offlineimap</code> to <code>test-offlineimap-{name}</code> (where <code>{name}</code> is your name) before continuing to avoid conflicts later in this guide.
                </p>
              </div>
              <p>The <code>command</code> specifies the path to the binary to be run. This is resolved relative to the root of your snap contents and automatically searches in the usr/sbin, usr/bin, sbin, and bin subdirectories of your snap.</p>
              <p>If your command name matches the snap name, users will be able run the command directly.</p>
            </div>
          </li>
        </ol>
      </div>
    </div>

    <div class="row">
      <hr />
    </div>

    <div class="row">
      <p class="u-float--left">Next, we'll build and test the snap.</p>
      <a class="p-button--positive u-float--right js-continue" href="/first-snap/{{ language }}/{{ os }}/build">Continue</a>
    </div>

  </div>
{% endblock %}

{% block scripts_modules %}
  <script src="{{ static_url('js/modules/clipboard.min.js') }}"></script>
{% endblock %}

{% block scripts %}
  <script>
    Raven.context(function() {
      if (typeof ClipboardJS !== 'undefined') {
        new ClipboardJS('.js-clipboard-copy');
      }
    });
  </script>
{% endblock %}